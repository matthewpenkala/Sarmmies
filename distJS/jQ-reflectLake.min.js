!function(t){jQuery.fn.lake=function(e){var o,c,d,m,u=t.extend({speed:1,scale:1,waves:10,image:!0},e),f=u.waves,l=u.speed/4,w=u.scale/2,a=document.createElement("canvas"),I=a.getContext("2d"),e=this.get(0),p=!1;e.parentNode.insertBefore(a,e);var D=0,j=0,x=0,y=[];return e.onload=function(){I.save(),I.canvas.width=this.width,I.canvas.height=2*this.height,I.drawImage(this,0,0),I.scale(1,-1),I.drawImage(this,0,2*-this.height),p=!0,I.restore(),o=I.canvas.width,c=I.canvas.height,d=o,m=c/2;var e=I.getImageData(0,c/2,o,c).data,a=!1;for(I.save();!a;){for(var t=I.getImageData(0,c/2,o,c),s=t.data,i=0,h=0;h<m;h++)for(var n=0;n<d;n++){var r,g=10*w*Math.sin(m/(h/f)-D)|0,v=4*((g+h)*o+n+g);v<0?i+=4:((r=v%(4*o))<(g=10*w*(h/f))||4*o-g<r?(r=h<o/2?1:-1,s[i]=s[i+4*r],s[++i]=s[i+4*r],s[++i]=s[i+4*r],s[++i]=s[i+4*r]):0!=e[3+v]?(s[i]=e[v],s[++i]=e[++v],s[++i]=e[++v],s[++i]=e[++v]):(s[i]=s[i-4*o],s[++i]=s[i-4*o],s[++i]=s[i-4*o],s[++i]=s[i-4*o]),++i)}6/l*l<D?(x=j-1,a=!(j=D=0)):(D+=l,j++),y.push(t)}I.restore(),u.image||(I.height=I.height/2)},setInterval(function(){p&&(u.image?I.putImageData(y[j],0,c/2):I.putImageData(y[j],0,0),j<x?j++:j=0)},33),this}}(jQuery);