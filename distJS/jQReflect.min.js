!function(l){l.fn.extend({reflect:function(o){return o=l.extend({height:1/3,opacity:.5},o),this.unreflect().each(function(){var n=this;function t(){var t,e,a,i=n.width,r=n.height,s=Math.floor(1<o.height?Math.min(r,o.height):r*o.height),c=l("<canvas />")[0];if(c.getContext){e=c.getContext("2d");try{l(c).attr({width:i,height:s}),e.save(),e.translate(0,r-1),e.scale(1,-1),e.drawImage(n,0,0,i,r),e.restore(),e.globalCompositeOperation="destination-out",(a=e.createLinearGradient(0,0,0,s)).addColorStop(0,"rgba(255, 255, 255, "+(1-o.opacity)+")"),a.addColorStop(1,"rgba(255, 255, 255, 1.0)"),e.fillStyle=a,e.rect(0,0,i,s),e.fill()}catch(t){return}}else{if(!window.ActiveXObject)return;c=l("<img />").attr("src",n.src).css({width:i,height:r,marginBottom:s-r,filter:"FlipV progid:DXImageTransform.Microsoft.Alpha(Opacity="+100*o.opacity+", FinishOpacity=0, Style=1, StartX=0, StartY=0, FinishX=0, FinishY="+s/r*100+")"})[0]}l(c).css({display:"block",border:0}),(t=l(/^a$/i.test(n.parentNode.tagName)?"<span />":"<div />").insertAfter(n).append([n,c])[0]).className=n.className,l.data(n,"reflected",t.style.cssText=n.style.cssText),l(t).css({width:i,height:r+s,overflow:"hidden"}),n.style.cssText="display: block; border: 0px",n.className="reflected"}/^img$/i.test(n.tagName)&&(n.complete?t():l(n).load(t))})},unreflect:function(){return this.unbind("load").each(function(){var t,e=this,a=l.data(this,"reflected");void 0!==a&&(t=e.parentNode,e.className=t.className,e.style.cssText=a,l.removeData(e,"reflected"),t.parentNode.replaceChild(e,t))})}})}(jQuery),jQuery(function(t){t("img.reflect").reflect({})});
